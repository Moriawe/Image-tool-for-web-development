<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Image Tools for Web Development{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Chelsea+Market&display=swap" rel="stylesheet">
  <script>
    // Global function for format options - available immediately
    function updateFormatOptions() {
      toggleFormatOptions();
    }
    
    function toggleFormatOptions(prefix = '') {
      const formatSelect = document.getElementById(prefix ? `${prefix}_format_type` : 'output_format');
      const qualitySection = document.getElementById(prefix ? `${prefix}_quality_option` : 'quality_section');
      const losslessSection = document.getElementById(prefix ? `${prefix}_lossless_option` : 'lossless_section');
      const formatInfo = document.getElementById(prefix ? `${prefix}_format_info` : 'format_info');
      
      if (!formatSelect) return;
      
      const format = formatSelect.value;
      
      // Format-specific information
      const formatInfoData = {
        webp: {
          title: "WebP Benefits:",
          points: [
            "25-35% smaller than JPEG",
            "Supports transparency", 
            "Excellent browser support"
          ]
        },
        avif: {
          title: "AVIF Benefits:",
          points: [
            "50% smaller than JPEG",
            "Superior compression",
            "Growing browser support"
          ]
        },
        jpeg: {
          title: "JPEG Benefits:",
          points: [
            "Universal compatibility",
            "Small file sizes",
            "Best for photos"
          ]
        },
        png: {
          title: "PNG Benefits:",
          points: [
            "Lossless compression",
            "Supports transparency",
            "Best for graphics & logos"
          ]
        }
      };
      
      // Update format info if element exists
      if (formatInfo && formatInfoData[format]) {
        const info = formatInfoData[format];
        formatInfo.innerHTML = `
          <h4>${info.title}</h4>
          <ul style="font-size: 0.85em; margin: 0.5rem 0;">
            ${info.points.map(point => `<li>${point}</li>`).join('')}
          </ul>
        `;
      }
      
      // Show/hide options based on format
      if (format === 'png') {
        // PNG is inherently lossless
        if (qualitySection) qualitySection.style.display = 'none';
        if (losslessSection) losslessSection.style.display = 'none';
      } else if (format === 'jpeg') {
        // JPEG doesn't support lossless
        if (qualitySection) qualitySection.style.display = 'block';
        if (losslessSection) losslessSection.style.display = 'none';
      } else {
        // WebP and AVIF support both
        if (qualitySection) qualitySection.style.display = 'block';
        if (losslessSection) losslessSection.style.display = 'block';
      }
    }
  </script>
  <style>
    body{font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;padding:2rem;background:#f6f7f9;color:#111}
    .card{max-width:900px;margin:0 auto;background:#fff;border-radius:14px;padding:0;box-shadow:0 8px 30px rgba(0,0,0,.06);overflow:hidden}
    .header{padding:1.5rem;border-bottom:1px solid #e5e7eb}
    .content{padding:1.5rem}
    h1{margin:0 0 .5rem 0;font-family:'Chelsea Market',cursive;color:#0ea5e9;font-size:2rem}
    .stylish-title{font-family:'Chelsea Market',cursive;color:#0ea5e9}
    .tabs{display:flex;gap:0;margin-bottom:1rem}
    .tab{padding:.75rem 1.5rem;background:#f8fafc;border:1px solid #e5e7eb;border-bottom:0;cursor:pointer;text-decoration:none;color:#374151;border-radius:8px 8px 0 0;margin-right:2px;font-weight:500}
    .tab.active{background:#fff;color:#0ea5e9;border-bottom:1px solid #fff;margin-bottom:-1px;position:relative;z-index:1;font-weight:600}
    .tab:hover{background:#f1f5f9;color:#0ea5e9}
    .tab-content{display:none;border:1px solid #e5e7eb;border-radius:0 8px 8px 8px;padding:1.5rem;background:#fff}
    .tab-content.active{display:block}
    fieldset{border:1px solid #e5e7eb;border-radius:10px;margin:.75rem 0 1rem;padding:1rem}
    legend{font-weight:600;color:#374151}
    label{display:block;margin:.5rem 0 .25rem}
    input[type="file"]{width:100%}
    input[type="text"]{width:100%;padding:.5rem;border:1px solid #e5e7eb;border-radius:6px;background:#fff}
    input[type="range"]{width:100%}
    select{width:100%;padding:.5rem;border:1px solid #e5e7eb;border-radius:6px;background:#fff}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    .size-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.5rem;margin:.5rem 0}
    .size-option{display:flex;align-items:center;gap:.5rem}
    .actions{display:flex;gap:.75rem;align-items:center;margin-top:.5rem}
    button{padding:.6rem 1rem;border-radius:8px;border:0;background:#0ea5e9;color:white;cursor:pointer;transition:background-color 0.2s}
    button:hover{background:#0284c7}
    .muted{color:#555;font-size:.9em}
    .list{margin-top:1rem;padding-left:1rem}
    .ok{color:#059669;font-weight:600}
    .warn{color:#b45309;font-weight:600}
    .code-block{background:#f8fafc;border:1px solid #e5e7eb;border-radius:6px;padding:1rem;margin:1rem 0;font-family:monospace;font-size:.9em;overflow-x:auto;white-space:pre-wrap}
    .badge{display:inline-block;background:#e0f2fe;color:#0369a1;padding:.2rem .5rem;border-radius:4px;font-size:.8em;margin-left:.5rem}
    .results{margin-top:2rem;padding-top:2rem;border-top:1px solid #e5e7eb}
    {% block extra_css %}{% endblock %}
  </style>
</head>
<body>
<div class="card">
  <div class="header">
    <h1>{% block header %}ðŸŽ¨ Image Tools for Web Development{% endblock %}</h1>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <p class="warn">{{ messages[0] }}</p>
      {% endif %}
    {% endwith %}
  </div>

  <div class="content">
    {% block content %}{% endblock %}
  </div>
</div>

<script>
// Quality range inputs update display
document.addEventListener('DOMContentLoaded', function() {
  const qualityInputs = document.querySelectorAll('input[type="range"]');
  qualityInputs.forEach(input => {
    const updateDisplay = () => {
      const outputId = input.getAttribute('oninput');
      if (outputId) {
        const displayElement = document.getElementById(outputId.split('.')[0]);
        if (displayElement) displayElement.textContent = input.value;
      }
    };
    input.addEventListener('input', updateDisplay);
    updateDisplay(); // Set initial value
  });
});

{% block extra_js %}{% endblock %}
</script>
</body>
</html>
